# **1.Data description:** 

**NYC_sim_obs_102.txt**:The infection scale of New York City from February 29 to June 8, 2020, artificially simulated and generated. The data length is 102.

**uhf_sim_obs_14_42.txt**: The infection scale of 42 UHFs (Neighborhood Tabulation Areas) in New York City from February 29 to June 8, 2020, artificially simulated and generated. The data is reported weekly, and the data scale is (14,42).

**date_list.txt**: A text file recording dates, used to read the abscissa of the graph.

**density.txt**: The weekly average density of different types of places for 42 weeks and 42 UHFs artificially generated. We have five types of places. The data dimension is (42,210). 
For example,the density of the j-th type of place in the i-th UHF in the t-th week is saved at density[t][5*i+j].

**dwell.txt**: The weekly average dwell time of different types of places for 42 weeks and 42 UHFs artificially generated. The dimension is stored in the same way as density.

**dict_dict_day2week**: A dictionary used to quickly obtain which week the current date t is starting from February 24.

**M_norm.txt**: M_norm.txt is regarded as the mobility data.  It is a flow ratio matrix obtained artificially. The scale is (292,42,210). 
For example,the flow ratio of people living in the i-th UHF on the t-th day going to the p-th type of place in the j-th UHF is saved at M[t][i][j*5+p].

**NY_humudity_1.csv**: The average daily humidity data of New York City from 1979 to 2011 (33 years).

**NYCpop.xlsx**: The population data of New York City in 2020.

**obs_rate_poly_uhf.csv**: The daily UHF reporting rate of NYC from February 26 to December 13 generated by fitting a fourth-order polynomial.

**uhfOrder.xlsx**: A table used to read UHF numbers and UHF information.

**week_set.txt**: A text file recording the Monday dates starting from March 1, used to read the abscissa of the UHF fitting graph.

---
# **2.Code description:** <br>

My local Python version is 3.10.15, and the compiler is Visual Studio Code. Both are suitable for running the following code.

## MH.ipynb

The function of this code is to train the key parameters in the model according to the existing UHF-level infection data to fit the real data. The measure of goodness and badness is log-likelihood. This code first needs to read necessary data such as mobility data, real infection data, humidity data, observation rate, etc. Then you can set the training times ‘n1’, the initial value ‘para_0’ of each parameter, and the perturbation variance ‘para_step’ by yourself, and run the Main program block. Finally, the currently trained parameters can generate simulated data, and the fitting situation at both the New York City and UHF levels can be intuitively seen in the plot part.

## EAKF.ipynb

The function of this code is to dynamically adjust the key parameters of the model weekly according to the current UHF-level infection data, generate retrospective predictions based on the average mobility data of the current week, and show the coverage of the predictions on the real infection data. This code first needs to read necessary data such as mobility data, real infection data, humidity data, observation rate, etc. Then you can set parameters such as the number of samples ’sam_num‘, the initial value ’p0‘ of each parameter, the sample state perturbation ratio ’k_s‘, and the parameter perturbation ratio ’k_p‘ by yourself, and run the Main program block. Finally, the currently trained parameters can generate one-week retrospective prediction data, and the prediction accuracy at both the New York City and UHF levels can be intuitively seen in the plot part.
